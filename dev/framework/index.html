<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Framework · NeuralEstimators.jl</title><meta name="title" content="Framework · NeuralEstimators.jl"/><meta property="og:title" content="Framework · NeuralEstimators.jl"/><meta property="twitter:title" content="Framework · NeuralEstimators.jl"/><meta name="description" content="Documentation for NeuralEstimators.jl."/><meta property="og:description" content="Documentation for NeuralEstimators.jl."/><meta property="twitter:description" content="Documentation for NeuralEstimators.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="NeuralEstimators.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">NeuralEstimators.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">NeuralEstimators</a></li><li class="is-active"><a class="tocitem" href>Framework</a></li><li><span class="tocitem">Workflow</span><ul><li><a class="tocitem" href="../workflow/overview/">Overview</a></li><li><a class="tocitem" href="../workflow/examples/">Examples</a></li><li><a class="tocitem" href="../workflow/advancedusage/">Advanced usage</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../API/core/">Core</a></li><li><a class="tocitem" href="../API/architectures/">Architectures</a></li><li><a class="tocitem" href="../API/loss/">Loss functions</a></li><li><a class="tocitem" href="../API/simulation/">Model-specific functions</a></li><li><a class="tocitem" href="../API/utility/">Miscellaneous</a></li><li><a class="tocitem" href="../API/">Index</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Framework</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Framework</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/msainsburydale/NeuralEstimators.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/msainsburydale/NeuralEstimators.jl/blob/main/docs/src/framework.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Framework"><a class="docs-heading-anchor" href="#Framework">Framework</a><a id="Framework-1"></a><a class="docs-heading-anchor-permalink" href="#Framework" title="Permalink"></a></h1><p>In this section, we provide an overview of point estimation using neural Bayes estimators. For a more detailed discussion on the framework and its implementation, see the paper <a href="https://www.tandfonline.com/doi/full/10.1080/00031305.2023.2249522">Likelihood-Free Parameter Estimation with Neural Bayes Estimators</a>. For an accessible introduction to amortised neural inferential methods more broadly, see the review paper <a href="https://arxiv.org/abs/2404.12484">Neural Methods for Amortised Inference</a>. </p><h3 id="Neural-Bayes-estimators"><a class="docs-heading-anchor" href="#Neural-Bayes-estimators">Neural Bayes estimators</a><a id="Neural-Bayes-estimators-1"></a><a class="docs-heading-anchor-permalink" href="#Neural-Bayes-estimators" title="Permalink"></a></h3><p>A parametric statistical model is a set of probability distributions on a sample space <span>$\mathcal{Z} \subseteq \mathbb{R}^n$</span>, where the probability distributions are parameterised via some parameter vector <span>$\boldsymbol{\theta}$</span> on a parameter space <span>$\Theta \subseteq \mathbb{R}^p$</span>. Suppose that we have data from one such distribution, which we denote as <span>$\boldsymbol{Z}$</span>. Then, the goal of parameter point estimation is to come up with an estimate of the unknown <span>$\boldsymbol{\theta}$</span> from <span>$\boldsymbol{Z}$</span> using an estimator,</p><p class="math-container">\[ \hat{\boldsymbol{\theta}} : \mathcal{Z} \to \Theta,\]</p><p>which is a mapping from the sample space to the parameter space.</p><p>Estimators can be constructed within a decision-theoretic framework. Consider a nonnegative loss function, <span>$L(\boldsymbol{\theta}, \hat{\boldsymbol{\theta}}(\boldsymbol{Z}))$</span>, which assesses an estimator <span>$\hat{\boldsymbol{\theta}}(\cdot)$</span> for a given <span>$\boldsymbol{\theta}$</span> and data set <span>$\boldsymbol{Z} \sim f(\boldsymbol{z} \mid \boldsymbol{\theta})$</span>, where <span>$f(\boldsymbol{z} \mid \boldsymbol{\theta})$</span> is the probability density function of the data conditional on <span>$\boldsymbol{\theta}$</span>. An estimator&#39;s <em>Bayes risk</em> is its loss averaged over all possible parameter values and data realisations,</p><p class="math-container">\[\int_\Theta \int_{\mathcal{Z}}  L(\boldsymbol{\theta}, \hat{\boldsymbol{\theta}}(\boldsymbol{z}))f(\boldsymbol{z} \mid \boldsymbol{\theta}) \rm{d} \boldsymbol{z} \rm{d} \Pi(\boldsymbol{\theta}),  \]</p><p>where <span>$\Pi(\cdot)$</span> is a prior measure for <span>$\boldsymbol{\theta}$</span>. Any minimiser of the Bayes risk is said to be a <em>Bayes estimator</em> with respect to <span>$L(\cdot, \cdot)$</span> and <span>$\Pi(\cdot)$</span>.</p><p>Bayes estimators are theoretically attractive: for example, unique Bayes estimators are admissible and, under suitable regularity conditions and the squared-error loss, are consistent and asymptotically efficient. Further, for a large class of prior distributions, every set of conditions that imply consistency of the maximum likelihood (ML) estimator also imply consistency of Bayes estimators. Importantly, Bayes estimators are not motivated purely by asymptotics: by construction, they are Bayes irrespective of the sample size and model class. Unfortunately, however, Bayes estimators are typically unavailable in closed form for the complex models often encountered in practice. A way forward is to assume a flexible parametric model for <span>$\hat{\boldsymbol{\theta}}(\cdot)$</span>, and to optimise the parameters within that model in order to approximate the Bayes estimator. Neural networks are ideal candidates, since they are universal function approximators, and because they are also fast to evaluate, usually involving only simple matrix-vector operations.</p><p>Let <span>$\hat{\boldsymbol{\theta}}(\boldsymbol{Z}; \boldsymbol{\gamma})$</span> denote a neural network that returns a point estimate from data <span>$\boldsymbol{Z}$</span>, where <span>$\boldsymbol{\gamma}$</span> contains the neural-network parameters. Bayes estimators may be approximated with <span>$\hat{\boldsymbol{\theta}}(\cdot; \boldsymbol{\gamma}^*)$</span> by solving the optimisation problem,  </p><p class="math-container">\[\boldsymbol{\gamma}^*
\equiv
\underset{\boldsymbol{\gamma}}{\mathrm{arg\,min}} \; 
\frac{1}{K} \sum_{k = 1}^K L(\boldsymbol{\theta}, \hat{\boldsymbol{\theta}}(\boldsymbol{z}; \boldsymbol{\gamma})),\]</p><p>whose objective function is a Monte Carlo approximation of the Bayes risk made using a set <span>$\{\boldsymbol{\theta}^{(k)} : k = 1, \dots, K\}$</span> of parameter vectors sampled from the prior <span>$\Pi(\cdot)$</span> and, for each <span>$k$</span>, data <span>$\boldsymbol{Z}^{(k)}$</span> simulated from <span>$f(\boldsymbol{z} \mid  \boldsymbol{\theta})$</span>. Note that this Monte Carlo approximation does not involve evaluation, or knowledge, of the likelihood function.</p><p>The Monte Carlo approximation of the Bayes risk can be straightforwardly minimised with respect to <span>$\boldsymbol{\gamma}$</span> using back-propagation and stochastic gradient descent. For sufficiently flexible architectures, the point estimator targets a Bayes estimator with respect to <span>$L(\cdot, \cdot)$</span> and <span>$\Pi(\cdot)$</span>. We therefore call the fitted neural point estimator a  <em>neural Bayes estimator</em>. Like Bayes estimators, neural Bayes estimators target a specific point summary of the posterior distribution. For instance, the absolute-error and squared-error loss functions lead to neural Bayes estimators that approximate the posterior median and mean, respectively.</p><h3 id="Construction-of-neural-Bayes-estimators"><a class="docs-heading-anchor" href="#Construction-of-neural-Bayes-estimators">Construction of neural Bayes estimators</a><a id="Construction-of-neural-Bayes-estimators-1"></a><a class="docs-heading-anchor-permalink" href="#Construction-of-neural-Bayes-estimators" title="Permalink"></a></h3><p>The neural Bayes estimators is conceptually simple and can be used in a wide range of problems where other approaches, such as maximum-likelihood estimation, are computationally infeasible. The estimator also has marked practical appeal, as the general workflow for its construction is only loosely connected to the statistical or physical model being considered. The workflow is as follows:</p><ol><li>Define the prior, <span>$\Pi(\cdot)$</span>.</li><li>Choose a loss function, <span>$L(\cdot, \cdot)$</span>, typically the mean-absolute-error or mean-squared-error loss.</li><li>Design a suitable neural-network architecture for the neural point estimator <span>$\hat{\boldsymbol{\theta}}(\cdot; \boldsymbol{\gamma})$</span>.</li><li>Sample parameters from <span>$\Pi(\cdot)$</span> to form training/validation/test parameter sets.</li><li>Given the above parameter sets, simulate data from the model, to form training/validation/test data sets.</li><li>Train the neural network (i.e., estimate <span>$\boldsymbol{\gamma}$</span>) by minimising the loss function averaged over the training sets. During training, monitor performance and convergence using the validation sets.</li><li>Assess the fitted neural Bayes estimator, <span>$\hat{\boldsymbol{\theta}}(\cdot; \boldsymbol{\gamma}^*)$</span>, using the test set.</li></ol></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« NeuralEstimators</a><a class="docs-footer-nextpage" href="../workflow/overview/">Overview »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Monday 15 July 2024 23:32">Monday 15 July 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
